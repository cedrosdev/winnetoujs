(()=>{"use strict";const e={constructosPath:"./constructos",constructosOut:"./js/constructos",entry:"./js/app.js",out:"./release",sass:"./sass",defaultLang:"en-us",publicPath:"/",cssOut:"./release"},t=new class{constructor(){this.constructoId=0,this.mutable=[],this.usingMutable=[],this.routes={},this.paramRoutes=[],this.routesOptions={},this.storedEvents=[],this.strings={},document.addEventListener("keydown",(e=>{27===e.which&&history.go(-1)})),window.history&&window.history.pushState&&(window.onpopstate=e=>{var t;if(e.preventDefault(),null==e.state)this.routes["/"]();else try{this.callRoute(e.state)}catch(t){console.error(`WinnetouJs Error, id: CR002\nGiven route is not available "${e.state}". Please verify given route. Original Error: ${t}`)}if(null!==(t=this.routesOptions)&&void 0!==t&&t.onBack)try{this.routesOptions.onBack()}catch(e){console.error("Winnetou Error, id: CR001\nThe onBack option in createRoutes() is not valid. Please use a function. \n\nOriginal Error: ",e)}});let e=window.localStorage.getItem("theme");if(e){e=JSON.parse(e);let t=document.documentElement;Object.keys(e).forEach((function(n){t.style.setProperty(n,e[n])}))}}setMutable(e,t,n=!0){if(n&&"notPersistent"!==n?window.localStorage.setItem(`mutable_${e}`,t):this.mutable[e]=t,this.usingMutable[e]){let t=this.usingMutable[e];this.usingMutable[e]=[],t.forEach((e=>{let t=document.getElementById(e.pureId);if(null==t)return;let n=(new e.method).constructo,o=document.createRange().createContextualFragment(n(e.elements,e.options).constructoString());this.replace(o,t)}))}}initMutable(e){let t=((new Date).getMilliseconds()*Math.random()*1e4).toFixed(0);return this.setMutable(t,e,"notPersistent"),t}getMutable(e){return window.localStorage.getItem(`mutable_${e}`)||""===window.localStorage.getItem(`mutable_${e}`)?window.localStorage.getItem(`mutable_${e}`):this.mutable[e]||""===this.mutable[e]?this.mutable[e]:null}replace(e,t){t&&t.parentNode&&t.parentNode.replaceChild(e,t)}select(e=""){var t;const n={getEl(e){if(t)return t;if("object"==typeof e)return[e];if(e.includes(" "))return document.querySelectorAll(e);if(e.match(/^\#/))return e=e.replace("#",""),[document.getElementById(e)];if(e.match(/^\./))return e=e.replace(".",""),Array.from(document.getElementsByClassName(e));{if(e.includes("-win-"))return e=e.replace("#",""),[document.getElementById(e)];let t=Array.from(document.getElementsByTagName(e));return 0===t.length?[document.getElementById(e)]:t}},remove(){return t.forEach((e=>{e.remove()})),this},html(e){return t.forEach((t=>{t.innerHTML=e})),this},getHtml:()=>t[0].innerHTML,getText:()=>t[0].textContent,append(e){return t.forEach((t=>{t.innerHTML+=e})),this},prepend(e){return t.forEach((t=>{t.innerHTML=e+t.innerHTML})),this},css(e,n){let o=n;return t.forEach((t=>{"number"==typeof n&&(o=n+"px"),t.style[e]=o})),this},toggleClass(e){return t.forEach((t=>{t.classList.toggle(e)})),this},addClass(e){return t.forEach((t=>{t.classList.add(e)})),this},removeClass(e){return t.forEach((t=>{t.classList.remove(e)})),this},hide(){return t.forEach((e=>{e.classList.add("winnetou_display_none")})),this},show(){return t.forEach((e=>{e.classList.remove("winnetou_display_none"),"none"==getComputedStyle(e).display&&(e.style.display="initial")})),this},getWidth:()=>t[0].getBoundingClientRect().width,getHeight:()=>t[0].getBoundingClientRect().height,getLeft:()=>t[0].offsetLeft,getTop:()=>t[0].offsetTop,getGlobalPosition:()=>t[0].getBoundingClientRect(),getVal:()=>t[0].value,setVal(e){return t.forEach((t=>{if(t.value=e,"createEvent"in document){var n=document.createEvent("HTMLEvents");n.initEvent("change",!1,!0),t.dispatchEvent(n)}else t.fireEvent("onchange")})),this},setAttr(e,n){return t.forEach((t=>{t.setAttribute(e,n)})),this},getAttr:e=>t[0].getAttribute(e),isChecked:()=>t[0].checked,getFile:()=>t[0].files[0],getFiles:()=>t[0].files,getScrollTop:()=>t[0].scrollTop,disable(){return t[0].disabled=!0,this},enable(){return t[0].disabled=!1,this}};if(null===(t=n.getEl(e))[0]){console.warn(`WinnetouJs Warning: The provided element selector (${e}) does not exists in DOM. Winnetou is skipping this fatal error, but verify.`);let n=this.vdom();n.appendChild(document.createRange().createContextualFragment("<p class='foo'>")),t=n.querySelectorAll(".foo")}return n}createRoutes(e,t){this.routes=e,this.routesOptions=t,Object.keys(this.routes).forEach((e=>{let t=e.split("/").length;this.paramRoutes.push({root:e,size:t})}))}navigate(e,t=!0){var n;if(window.history&&window.history.pushState&&(this.callRoute(e),t&&this.pushState(e),null!==(n=this.routesOptions)&&void 0!==n&&n.onGo))try{this.routesOptions.onGo()}catch(e){console.error("Winnetou Error, id: CR001\nThe onGo option in createRoutes() is not valid. Please use a function. \n\nOriginal Error: ",e)}}pass(e){var t;if(window.history&&window.history.pushState&&(this.callRoute(e),this.pushStateInteraction(e),null!==(t=this.routesOptions)&&void 0!==t&&t.onGo))try{this.routesOptions.onGo()}catch(e){console.error("Winnetou Error, id: CR001\nThe onGo option in createRoutes() is not valid. Please use a function. \n\nOriginal Error: ",e)}}pushStateInteraction(e){history.pushState(e,null)}callRoute(e){try{let t=e.split("/"),n=t.length,o=this.paramRoutes.filter((e=>e.size===n));0===o.length&&this.notFound();for(let e=0;e<o.length;e++){let n=o[e].root.split("/"),r=!0,s=[];for(let e=0;e<n.length;e++)if(n[e]!==t[e]){if(r=!1,!n[e].includes(":")){r=!1;break}r=!0,s.push(t[e])}if(r)return void this.routes[o[e].root](...s);e===o.length-1&&this.notFound()}}catch(e){console.log(e),this.notFound()}}notFound(){try{this.routes["/404"]()}catch(e){this.select("body").prepend("\n      \n      <p onclick=\"Winnetou.select('.winnetouNotFoundDefault').hide()\" style=\"width:100%;padding:15px;color:white;background-color:red;cursor:pointer;\" class='winnetouNotFoundDefault'>\n        Page not found. Click to close.\n      </p>\n      ")}}pushState(e){try{history.pushState(e,"",e)}catch(t){history.pushState(e,null)}}fx(e,t=""){let n="winnetouFx"+((new Date).getMilliseconds()*Math.random()*1e4).toFixed(0);return window[n]=e,`${n}(${t})`}listen(e,t,n){try{document.querySelector("#"+t).addEventListener(e,(e=>{n(e)}))}catch(o){document.querySelectorAll(t).forEach((t=>{t.addEventListener(e,(e=>{n(e)}))}))}}on(e,t,n,o){if(!(this.storedEvents.filter((o=>o.eventName===e&&o.elementSelector===t&&o.callback===n.toString())).length>0))switch(this.storedEvents.push({eventName:e,elementSelector:t,callback:n.toString()}),e){case"scroll":try{document.querySelector("#"+t).addEventListener("scroll",(e=>{n(e)}))}catch(e){document.querySelector(t).addEventListener("scroll",(e=>{n(e)}))}break;case"click":e="ontouchstart"in document.documentElement?"touchstart":"click",document.addEventListener(e,r);break;default:document.addEventListener(e,r)}function r(e){let r="#"+t;if(!e.target.closest(t))try{if(!e.target.closest(r))return}catch(e){return}let s=!0,l=e.path||e.composedPath&&e.composedPath();for(let a=0;a<l.length;a++){let i=l[a];if(o&&o.remove)for(let t=0;t<o.remove.length;t++)try{i.matches(o.remove[t])&&(s=!1),i.matches("#"+o.remove[t])&&(s=!1)}catch(e){}try{i.matches(t)?s&&n(i):i.matches(r)&&s&&n(i)}catch(e){}}}}click(e,t,n){var o="ontouchstart"in document.documentElement?"touchstart":"click";this.on(o,e,(e=>{t(e)}),n)}async lang(t,n){if(!window.localStorage.getItem("lang"))return n();let o=t,r=null==e?void 0:e.defaultLang,s=window.localStorage.getItem("lang");s&&(r=s);var l=new XMLHttpRequest;l.onreadystatechange=function(){if(4==this.readyState&&404==this.status&&(console.log("\nThe file ",`./translations/${r}.xml`,"are not found"),window.localStorage.removeItem("lang"),location.reload()),4==this.readyState&&200==this.status){try{this.responseXML.getElementsByTagName("winnetou")[0].childNodes.forEach((e=>{"#text"!=e.nodeName&&(o[e.nodeName]=e.textContent)}))}catch(e){console.log("The translation file ",`./translations/${r}.xml`," seems to be empty or incorrect.",e.message)}return n()}},l.open("GET",`./translations/${r}.xml`,!0),l.send()}async updateTranslations(t){return new Promise((async(n,o)=>{if(!window.localStorage.getItem("lang"))return n();let r=t;null!=e&&e.publicPath||(console.error("WinnetouJs updateTranslations Miss Configuration Error:You have to specify the public path in order to use the translations;"),e.publicPath=""),"/"===e.publicPath&&(e.publicPath="");let s,l=null==e?void 0:e.defaultLang,a=window.localStorage.getItem("lang");a&&(l=a);try{s=await(i=`${e.publicPath}/translations/${l}.json`,new Promise(((e,t)=>{fetch(i,{method:"GET"}).then((function(e){return e.ok?e.json():t("Translation file not found. Code error kj438dj.")})).then((function(t){return e(t)})).catch((function(e){return t("Translation file not found. Code error kj438dssj.")}))})))}catch(t){console.warn(`Lang error. Reloading...\n\n\nThe file '${e.publicPath}/translations/${l}.json' was not found. Did you set publicPath in win.config.js and created json translation file?`),window.localStorage.removeItem("lang"),setTimeout((()=>{location.reload()}),200)}var i;return Object.keys(s).map((e=>{let t=s[e];r[e]=t})),n()}))}changeLang(e){window.localStorage.setItem("lang",e),location.reload()}newTheme(e){let t=document.documentElement;Object.keys(e).forEach((function(n){t.style.setProperty(n,e[n])})),window.localStorage.setItem("theme",JSON.stringify(e))}vdom(){return document.createDocumentFragment()}create(e,t,n){let o=document.querySelectorAll(t);0===o.length&&(o=document.querySelectorAll("#"+t)),o.forEach((t=>{n&&n.clear&&(t.innerHTML=""),n&&n.reverse?t.prepend(e):t.appendChild(e)}))}},n=t.strings={welcome:"Congratulations! Your winnetoujs app is health and running.",text:"To start coding, edit <i>app.js</i> file and run <b>node wbr --bundleRelease</b> in your terminal."};class o{_mutableToString(e){if(e){let n=JSON.parse(JSON.stringify(e));return Object.keys(e).forEach((o=>{if("object"==typeof e[o]&&null!==e[o]){let r,s=e[o].mutable;r=t.getMutable(s)||""===t.getMutable(s)?t.getMutable(s):`Mutable "${s}" not initialized yet.`,n[o]=r}})),n}return e}_saveUsingMutable(e,n,o,r){n&&Object.keys(n).forEach((s=>{if("object"==typeof n[s]&&null!==n[s]){t.usingMutable[n[s].mutable]||(t.usingMutable[n[s].mutable]=[]);let l={pureId:e,elements:n,options:o,method:r};t.usingMutable[n[s].mutable].filter((t=>t.pureId==e)).length>0||t.usingMutable[n[s].mutable].push(l)}})),o&&Object.keys(o).forEach((s=>{if("object"==typeof o[s]&&null!==o[s]){t.usingMutable[o[s].mutable]||(t.usingMutable[o[s].mutable]=[]);let l={pureId:e,elements:n,options:o,method:r};t.usingMutable[o[s].mutable].filter((t=>t.pureId==e)).length>0||t.usingMutable[o[s].mutable].push(l)}}))}_getIdentifier(e){return"notSet"!=e?e:++t.constructoId}create(e,n,o){let r;if(e.match(/^\s*?<tr|^\s*?<td|^\s*?<table|^\s*?<th|^\s*?<tbody|^\s*?<thead|^\s*?<tfoot/)){let t=document.querySelectorAll(n);0===t.length&&(t=document.querySelectorAll("#"+n)),t.forEach((t=>{o&&o.clear&&(t.innerHTML=""),o&&o.reverse?t.innerHTML=e+t.innerHTML:t.innerHTML+=e}))}else if(r=document.createRange().createContextualFragment(e),"object"!=typeof n){let e;o&&o.vdom?(e=o.vdom.querySelectorAll(n),0===e.length&&(e=o.vdom.querySelectorAll("#"+n))):(e=document.querySelectorAll(n),0===e.length&&(e=document.querySelectorAll("#"+n))),e.forEach((e=>{o&&o.replace?t.replace(r,e):(o&&o.clear&&(e.innerHTML=""),o&&o.reverse?e.prepend(r):e.appendChild(r))}))}else o&&o.clear&&(n.innerHTML=""),o&&o.reverse?n.prepend(r):n.appendChild(r)}}class r extends o{constructo=(e,t)=>{let n=this._mutableToString(t);n=this._getIdentifier(t&&n.identifier||"notSet");let o,s=this._mutableToString(e),l={code:e=>`\n  <div id="welcome-win-${n}" class="welcome">\n    <img src="https://raw.githubusercontent.com/cedrosdev/winnetoujs_assets/master/logo_v1_2020/logo_transparent.png"\n      class="logo"\n    >\n    <h1>WinnetouJs</h1>\n    <h2>${null==e?void 0:e.title}</h2>\n    <span class="text">${null==e?void 0:e.text}</span>\n    <p class="main_link">\n      <a href="https://winnetoujs.org" target="_blank">winnetoujs.org</a>\n    </p>\n  </div>\n`,create:(e,t)=>(this.create(o,e,t),{ids:{welcome:`welcome-win-${n}`},code:l.code(s)}),constructoString:()=>l.code(s)};return o=l.code(s),this._saveUsingMutable(`welcome-win-${n}`,e,t,r),l}}const s=(new r).constructo;t.updateTranslations(n).then((()=>async function(){s({title:n.welcome,text:n.text}).create("#app")}()))})();
//# sourceMappingURL=winnetouBundle.min.js.map