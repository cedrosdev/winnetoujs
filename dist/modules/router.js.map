{
  "version": 3,
  "sources": ["../../src/modules/router.ts"],
  "sourcesContent": ["interface RouteOptions {\n  onBack?: (route: string) => void;\n  onGo?: (route: string) => void;\n}\n\ninterface RouteInfo {\n  root: string;\n  size: number;\n}\n\ntype RouteFunction = (...params: string[]) => void;\n\nclass WinnetouRouter_ {\n  protected routes: Record<string, RouteFunction> = {};\n  protected paramRoutes: RouteInfo[] = [];\n  protected routesOptions: RouteOptions = {};\n\n  constructor() {\n    this.addListeners();\n  }\n\n  addListeners(): void {\n    document.addEventListener(\"keydown\", (event: KeyboardEvent) => {\n      if (event.key === \"Escape\" || event.which === 27) {\n        history.go(-1);\n      }\n    });\n\n    if (window.history) {\n      window.onpopstate = (event: PopStateEvent) => {\n        event.preventDefault();\n\n        if (event.state == null) {\n          if (this.routes[\"/\"]) {\n            this.routes[\"/\"]();\n          } else {\n            console.error(\n              `WinnetouJs Error, id: CR00a67\\nDefault route \"/\" is not defined. Please define a default route.`\n            );\n          }\n        } else {\n          try {\n            this.callRoute(event.state);\n          } catch (e) {\n            console.error(\n              `WinnetouJs Error, id: CR002\\nGiven route is not available \"${event.state}\". Please verify given route. Original Error: ${e}`\n            );\n          }\n        }\n\n        if (this.routesOptions?.onBack) {\n          try {\n            this.routesOptions.onBack(event.state || \"/\");\n          } catch (e) {\n            console.error(\n              `Winnetou Error, id: CR001\\nThe onBack option in createRoutes() is not valid. Please use a function. \\n\\nOriginal Error: `,\n              e\n            );\n          }\n        }\n      };\n    }\n  }\n\n  createRoutes(\n    obj: Record<string, RouteFunction>,\n    options?: RouteOptions\n  ): void {\n    this.routes = obj;\n    this.routesOptions = options || {};\n\n    Object.keys(this.routes).forEach((route: string) => {\n      const segment = route.split(\"/\");\n      const size = segment.length;\n      this.paramRoutes.push({\n        root: route,\n        size,\n      });\n    });\n  }\n\n  navigate(url: string, pushState: boolean = true): void {\n    if (window.history) {\n      this.callRoute(url);\n      pushState && this.pushState(url);\n      if (this.routesOptions?.onGo) {\n        try {\n          this.routesOptions.onGo(url || \"/\"); // if url is undefined, it will be '/'\n        } catch (e) {\n          console.error(\n            `Winnetou Error, id: CR001\\nThe onGo option in createRoutes() is not valid. Please use a function. \\n\\nOriginal Error: `,\n            e\n          );\n        }\n      }\n    }\n  }\n\n  pass(route: string): void {\n    if (window.history) {\n      this.callRoute(route);\n      this.pushStateInteraction(route);\n      if (this.routesOptions?.onGo) {\n        try {\n          this.routesOptions.onGo(route || \"/\");\n        } catch (e) {\n          console.error(\n            `Winnetou Error, id: CR001\\nThe onGo option in createRoutes() is not valid. Please use a function. \\n\\nOriginal Error: `,\n            e\n          );\n        }\n      }\n    }\n  }\n\n  private pushStateInteraction(func: string): void {\n    history.pushState(func, \"\");\n  }\n\n  private callRoute(url: string): void {\n    try {\n      const splittedUrl = url.split(\"/\");\n      const size = splittedUrl.length;\n\n      const filter = this.paramRoutes.filter(data => data.size === size);\n\n      if (filter.length === 0) {\n        this.notFound();\n      }\n\n      for (let i = 0; i < filter.length; i++) {\n        const root = filter[i].root.split(\"/\");\n\n        let correctMatch = true;\n        const paramStore: string[] = [];\n        for (let j = 0; j < root.length; j++) {\n          if (root[j] !== splittedUrl[j]) {\n            correctMatch = false;\n            if (root[j].includes(\":\")) {\n              correctMatch = true;\n              paramStore.push(splittedUrl[j]);\n            } else {\n              correctMatch = false;\n              break;\n            }\n          }\n        }\n\n        if (correctMatch) {\n          this.routes[filter[i].root](...paramStore);\n          return;\n        } else if (i === filter.length - 1) {\n          this.notFound();\n        }\n      }\n    } catch (e) {\n      console.log(e);\n      this.notFound();\n    }\n  }\n\n  private notFound(): void {\n    try {\n      this.routes[\"/404\"]();\n    } catch (e) {\n      document.body.innerHTML =\n        \"<p onclick=\\\"Winnetou.select('.winnetouNotFoundDefault').hide()\\\" style=\\\"width:100%;padding:15px;color:white;background-color:red;cursor:pointer;\\\" class='winnetouNotFoundDefault'>Page not found. Click to close.</p>\" +\n        document.body.innerHTML;\n    }\n  }\n\n  private pushState(url: string): void {\n    try {\n      history.pushState(url, \"\", url);\n    } catch (e) {\n      history.pushState(url, \"\");\n    }\n  }\n}\n\nexport const Router = new WinnetouRouter_();\n"],
  "mappings": "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",
  "names": []
}
